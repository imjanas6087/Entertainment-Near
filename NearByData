package com.example.entertainmentnear;

import android.os.AsyncTask;

import com.google.android.gms.maps.CameraUpdateFactory;
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.model.LatLng;
import com.google.android.gms.maps.model.MarkerOptions;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import java.io.IOException;

public class NearByData extends AsyncTask<Object,String,String> {


    String NearData;
    GoogleMap map;
    String url_Data;


    @Override
    protected void onPostExecute(String s) {
        try{
            JSONObject object = new JSONObject();
            JSONArray jsonArray = object.getJSONArray("getResult");
            for(int i=0;i<jsonArray.length(); i++){
                JSONObject jsonObject = jsonArray.getJSONObject(i);
                JSONObject object1=jsonObject.getJSONObject("geometry").getJSONObject("location");

                String lat = object1.getString("lat");
                String lng = object1.getString("lng");

                JSONObject getName = jsonArray.getJSONObject(i);
                String name = getName.getString("name");

                LatLng latLng = new LatLng(Double.parseDouble(lat), Double.parseDouble(lng));
                MarkerOptions markerOptions = new MarkerOptions();
                markerOptions.title(name);
                markerOptions.position(latLng);
                map.addMarker(markerOptions);
                map.moveCamera(CameraUpdateFactory.newLatLngZoom(latLng, 15));
            }
        } catch (JSONException e) {
            e.printStackTrace();
        }
    }

    @Override
    protected String doInBackground(Object... objects) {
        try{
            map=(GoogleMap) objects[0];
            url_Data=(String)objects[1];
            Get_Place_Url place_url = new Get_Place_Url();
            NearData=place_url.retriveUrl(url_Data);
        } catch (IOException e) {
            e.printStackTrace();
        }
        return NearData;
    }
}
